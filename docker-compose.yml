version: '3.9'
services:
  # app:
  #   build:
  #     context: .
  #     # target: production
  #     dockerfile: Dockerfile.production
   
  #   ports:
  #     - "3001:3000"
  #   volumes:
  #     - ./:/app
  #     - /app/node_modules
  #   environment:
  #     NODE_ENV: production
  #   env_file:
  #     - ./.env.development
  #        required: true
  #   depends_on:
  #     - mongo
  #   networks:
  #     - node-network

  dev:
    build:
      context: .
      # target: development
      dockerfile: Dockerfile.development
    ports:
      - ${SERVER_PORT}:${SERVER_PORT}
    volumes:
      - ./:/app
      - /app/node_modules
    depends_on:
      - mongo
    networks:
      - node-network

  mongo:
    image: mongo:6-jammy
    container_name: ${DATABASE_HOST}
    ports:
      - ${DATABASE_PORT}:${DATABASE_PORT}
    volumes:
      - mongo-data:/data/db
    networks:
      - node-network

volumes:
  mongo-data:
    driver: local

networks:
  node-network:
    driver: bridge